<?php declare(strict_types=1);

// Copyright 2021 The Stellar PHP SDK Authors. All rights reserved.
// Use of this source code is governed by a license that can be
// found in the LICENSE file.

namespace Soneso\StellarSDK\Soroban;

use Soneso\StellarSDK\Xdr\XdrSCMapEntry;
use Soneso\StellarSDK\Xdr\XdrSCVal;

/**
 * Ed25519 signature for Soroban authorization entries
 *
 * This class represents an Ed25519 signature used in the authorization process for Soroban smart contracts.
 * It encapsulates the public key and signature bytes that are required for validating authorization entries.
 * The signature is typically created when signing authorization entries with a keypair.
 *
 * @package Soneso\StellarSDK\Soroban
 * @see SorobanAuthorizationEntry
 * @since 1.0.0
 */
class AccountEd25519Signature
{
    /**
     * @var string raw Ed25519 public key of 32 bytes used for signature verification
     */
    public string $publicKey;

    /**
     * @var string raw Ed25519 signature bytes generated by signing the authorization payload
     */
    public string $signatureBytes;

    /**
     * Creates a new Ed25519 signature for Soroban authorization.
     *
     * @param string $publicKey raw Ed25519 public key of 32 bytes used for verification
     * @param string $signatureBytes raw Ed25519 signature bytes produced by signing the payload
     */
    public function __construct(string $publicKey, string $signatureBytes)
    {
        $this->publicKey = $publicKey;
        $this->signatureBytes = $signatureBytes;
    }

    /**
     * Returns a scval map containing the public key and signature bytes.
     *
     * @return XdrSCVal the scval map containing the public key and signature bytes.
     */
    public function toXdrSCVal() : XdrSCVal {
        $pkMapEntry = new XdrSCMapEntry(XdrSCVal::forSymbol("public_key"), XdrSCVal::forBytes($this->publicKey));
        $sigMapEntry = new XdrSCMapEntry(XdrSCVal::forSymbol("signature"), XdrSCVal::forBytes($this->signatureBytes));
        return XdrSCVal::forMap([$pkMapEntry, $sigMapEntry]);
    }

    /**
     * Returns the raw Ed25519 public key.
     *
     * @return string raw public key of 32 bytes
     */
    public function getPublicKey(): string
    {
        return $this->publicKey;
    }

    /**
     * Sets the raw Ed25519 public key.
     *
     * @param string $publicKey raw public key of 32 bytes
     */
    public function setPublicKey(string $publicKey): void
    {
        $this->publicKey = $publicKey;
    }

    /**
     * Returns the raw Ed25519 signature bytes.
     *
     * @return string the raw signature bytes
     */
    public function getSignatureBytes(): string
    {
        return $this->signatureBytes;
    }

    /**
     * Sets the raw Ed25519 signature bytes.
     *
     * @param string $signatureBytes the raw signature bytes
     */
    public function setSignatureBytes(string $signatureBytes): void
    {
        $this->signatureBytes = $signatureBytes;
    }
}